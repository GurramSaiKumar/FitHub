<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <style>
        body {
            background-color: #f0f0f0; /* Light gray background color for the entire page */
            margin: 0; /* Remove default margin */
            padding: 0; /* Remove default padding */
            font-family: Arial, sans-serif; /* Use Arial font */
        }
        .panel {
            width: 250px;
            float: left;
            margin-right: 20px;
            background-color: #ffffff; /* White background color for the left panel */
            padding: 20px;
        }
        .panel ul {
            list-style-type: none;
            padding: 0;
        }
        .panel li {
            margin-bottom: 10px;
        }
        .panel li a {
            display: block;
            padding: 10px;
            background-color: #007bff;
            color: #fff;
            text-decoration: none;
            text-align: center;
        }
        .panel li a:hover {
            background-color: #0056b3;
        }
        .center-content {
            margin-top: 100px; /* Adjust top margin */
            text-align: center;
        }
        .data-container {
            display: flex;
            justify-content: space-around;
            margin-top: 50px;
        }
        .data-item {
            flex: 1;
            padding: 20px;
            background-color: #ffffff;
            border: 1px solid #ccc;
            border-radius: 5px;
            cursor: pointer; /* Change cursor to pointer on hover */
        }
        .data-item:hover {
            background-color: #f0f0f0; /* Light gray background color on hover */
        }
        .clients-list-container {
            text-align: center;
        }

        #clients-list {
            display: inline-block;
            text-align: left;
        }

    </style>
</head>
<body>
    <div class="panel">
        <ul>
            <li><a href="{% url 'clients:client' %}">Add Client</a></li>
            <li><a href="{% url 'clients:delete_clients' %}">Delete Client</a></li>
            <li><a href="{% url 'clients:update_client' %}">Update Client</a></li>
        </ul>
    </div>
    <div class="center-content">
        <h2>Client Statistics</h2>
        <div class="data-container">
            <div class="data-item" id="active-clients"> <!-- Add unique IDs to each statistic -->
                <h3>Active Clients</h3>
                <p>100</p> <!-- Dummy data: 100 active clients -->
            </div>
            <div class="data-item" id="expiring-clients">
                <h3>Expiring Soon Clients</h3>
                <p>50</p> <!-- Dummy data: 50 expiring soon clients -->
            </div>
            <div class="data-item" id="overdue-clients">
                <h3>Overdue Clients</h3>
                <p>20</p> <!-- Dummy data: 20 overdue clients -->
            </div>
        </div>
    </div>
    <!-- Centered list of clients -->
    <div class="center-content">
        <div id="clients-list-container" class="clients-list-container">
            <ul id="clients-list">
                <!-- Client items will be dynamically added here -->
            </ul>
        </div>
    </div>

    <script>
        // Function to make AJAX request and update content
        function fetchDataAndUpdate(id, endpoint) {
            fetch(endpoint)
            .then(response => response.json())
            .then(data => {
                document.getElementById(id).innerHTML = `
                    <h3>${data.title}</h3>
                    ${data.clients.map(client => `
                        <a class="client-link" href="/clients/${client.client_id}">${client.client_name}</a><br>
                    `).join('')}
                `;
            })
            .catch(error => console.error('Error:', error));
        }

        // Add click event listeners to each data-item
        document.getElementById('active-clients').addEventListener('click', function() {
            fetchDataAndUpdate('active-clients', '/clients/client');
        });

        document.getElementById('expiring-clients').addEventListener('click', function() {
            fetchDataAndUpdate('expiring-clients', '/api/clients/expiring');
        });

        document.getElementById('overdue-clients').addEventListener('click', function() {
            fetchDataAndUpdate('overdue-clients', '/api/clients/overdue');
        });

        // Function to fetch and display the list of clients
        function fetchAndDisplayClientList() {
            fetch('{% url 'clients:clients_list' %}')
            .then(response => response.json())
            .then(data => {
                const clientListContainer = document.getElementById('clients-list-container');
                // Clear existing list items
                clientListContainer.innerHTML = '';
                // Append new list items
                data.forEach(client => {
                    const listItem = document.createElement('li');
                    listItem.innerHTML = `${client.client_name} - ${client.client_number}`;
                    listItem.value = client.client_id; // Set client_id as the value
                    clientListContainer.appendChild(listItem);
                });
            })
            .catch(error => console.error('Error:', error));
        }

        // Call the function when the page loads
        window.onload = fetchAndDisplayClientList;
    </script>
</body>
</html>
